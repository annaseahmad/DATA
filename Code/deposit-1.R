#Data introduction#deposit<-read.csv("/Users/alvarocastilloalsina/Dropbox/00 Alvaro IESE/01 Tras aceptacion/09 Cases/05 Term/01 Subjects/04 Data/Assignment 2_my team/deposit.csv", stringsAsFactors=F)str(deposit)#Making deposit numeric 0-No and 1-Yes# deposit$deposit <- as.numeric(deposit$deposit=="yes") str(deposit)#Analysing each column##There is no problem with ÒageÓ because it is a numeric value. If it does not help a lot for increasing correlation, it for sure will not make the regression worst##Analysing ÒjobÓ## How relevant is each possible job outcomes#table(deposit$job)#Comparing deposit mean with each job outcomes mean. Deposit mean > job mean Ð low response to marketing campaigns. Deposit mean < job mean high response to marketing campaigns# mean(deposit$deposit) tapply(deposit$deposit, deposit$job, mean)#Clearly, retired and students are the highest positively correlated. On the other hand, it is better to join ÒunknownÓ, ÒadminÓ, Òself-employedÓ, and ÒtechnicianÓ, as they will barely influence the regression result and joining them it will be much simpler# deposit$job[deposit$job %in% c("admin", "self-employed", "technician", "unknown")]  <- "other" tapply(deposit$deposit, deposit$job, mean)#Analysing ÒmaritalÓ## How relevant is each possible ÒmaritalÓ outcomes# table(deposit$marital) tapply(deposit$deposit, deposit$marital, mean)# It makes sense to keep them as they are just 3, so 2 dummies##Analysing ÒeducationÓ## How relevant is each possible ÒeducationÓ outcomes# table(deposit$education) tapply(deposit$deposit, deposit$education, mean)# It also makes sense to them keep all##Analysing ÒdefaultÓ## How relevant is each possible ÒdefaultÓ outcomes# table(deposit$default) tapply(deposit$deposit, deposit$default, mean)#We can exclude those that have defaulted from the data base, as we do not want them as clients# table(deposit$default)#Analysing ÒhousingÓ## How relevant is each possible ÒhousingÓ outcomes# table(deposit$housing) tapply(deposit$deposit, deposit$housing, mean)#Analysing ÒpreviousÓ and ÒpdaysÓ#table(deposit$previous==0, deposit$pdays==-1)#These two variables tell us the same when they are previous==0 and pdays==-1# table(deposit$previous) tapply(deposit$deposit, deposit$previous==0, mean) tapply(deposit$deposit, deposit$previous, mean)#Looks like it makes sense to split in rates such us 0, 1, and >2# deposit$previous [deposit$previous >2] <- 2  tapply(deposit$deposit, deposit$pdays, mean)#There are several things to fix here: First -1 value. It means that it has never been contacted. Solution Ð do not use this one because most of the info is already in the previous variable# table(deposit$poutcome) tapply(deposit$deposit, deposit$poutcome, mean)#It makes sense to keep them all#fm<- (deposit) ~ age + job + marital + education + default + balance + housing + loan + contact + duration + factor(previous) + poutcomemod_log1<- glm(formula=fm, data=deposit[train,], family=binomial)pred_train1 <- predict(mod_log1, newdata=deposit[train,], type="response")cut = 0.2conf_train1 <- table(pred_train1 > cut, deposit[train,]$deposit==1); conf_train1  hist(pred_train1)cut = 0.15conf_train1 <- table(pred_train1 > cut, deposit[train,]$deposit==1); conf_train1   cut = 0.1conf_train1 <- table(pred_train1 > cut, deposit[train,]$deposit==1); conf_train1pred_real1 <- predict(mod_log1, newdata=deposit[-train,], type="response")conf_real1 <- table(pred_real1 > cut, deposit[-train,]$deposit==1); conf_real1